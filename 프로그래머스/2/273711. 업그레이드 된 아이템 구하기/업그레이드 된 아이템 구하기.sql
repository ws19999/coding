SELECT ITEM_ID, ITEM_NAME, RARITY
FROM ITEM_INFO a
JOIN ITEM_TREE b USING(ITEM_ID)
WHERE (PARENT_ITEM_ID IN (SELECT ITEM_ID FROM ITEM_INFO WHERE RARITY = 'RARE'))
ORDER BY ITEM_ID DESC